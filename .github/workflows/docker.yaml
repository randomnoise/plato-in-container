name: Docker CI

on: [push, pull_request]

env:
  REGISTRY: ghcr.io

jobs:
  docker-build:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        purpose: [builder, emulator]

    env:
      IMAGE_NAME: ghcr.io/${{ github.repository_owner }}/plato-${{ matrix.purpose }}

    # Experiments:
    # [x] Can I read env.IMAGE_NAME?
    # [x] Can I print git event name?
    # [] Can I recognize pull requests?
    # [] Can I use if conditions for steps?

    steps:
    - name: Checkout repository
      run: |
        set -eux -o pipefail
        echo ${{ env.IMAGE_NAME }}
        echo ${{ github.event_name }}
        echo ${{ github.event_name != 'pull_request' }}
